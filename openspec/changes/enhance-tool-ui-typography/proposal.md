# Change: 优化工具调用UI与字体排版

## Why

当前 AI Chat Panel 在工具调用显示和字体排版方面存在以下用户体验问题：

### 工具调用显示问题
1. **信息过载**：当前 ToolCallItem 组件会完整显示工具的参数和结果，用户需要点击展开才能看到细节，但默认显示了 "Click to see args" 这样的技术性提示
2. **缺乏语义化**：不同工具（如 createBlock、searchBlocksByTag）都使用相同的 🔧 图标和折叠卡片样式，缺乏差异化的视觉反馈
3. **割裂的流程**：工具调用（参数卡片）和工具结果（结果卡片）分成两个独立的可折叠区域，打断了对话流
4. **缺少进度感**：用户不清楚工具是否正在执行，只能看到静态的参数展示

### 字体排版问题
1. **屏幕利用率低**：当前字体设置（assistant 16px，行高 1.6）导致每屏显示的文字量较少
2. **字体选择不够优雅**：assistant 使用 Noto Serif CJK SC 等衬线字体，虽然典雅但在长对话场景下阅读效率不高
3. **信息密度与可读性平衡**：需要在容纳更多文字和保持易读之间找到最佳平衡点

## What Changes

### 1. 工具调用UI优化（Tool Call UX Enhancement）

#### 1.1 差异化工具显示
- **创建类工具**（createBlock, createPage, insertTag）：
  - 显示动态图标：✨ 闪烁的创造图标 + "正在创建/写入..."
  - 默认**不显示参数**，合并参数和结果到一个流畅的状态流
  - 状态流：调用中 → 完成（简洁的成功提示）

- **搜索类工具**（searchBlocksByTag, searchBlocksByText, queryBlocksByTag 等）：
  - 显示动态图标：🔍 脉动的搜索图标 + "正在搜索..."
  - 默认**不显示参数**，仅在结果中显示搜索关键词
  - 状态流：搜索中 → 找到 N 条结果

- **查询类工具**（getPage, getTodayJournal 等）：
  - 显示动态图标：📖 翻页图标 + "正在获取..."
  - 状态流：获取中 → 成功获取

#### 1.2 流式工具状态显示
- 不再使用可折叠的技术性卡片
- 用内联的、友好的状态提示替代（如 "正在搜索「任务」标签..."）
- 工具执行完成后，自动转换为结果摘要（如 "找到 12 条结果"）
- 用户可选择性点击查看详细参数（在 hover 菜单中提供）

### 2. 字体排版优化（Typography Enhancement）

#### 2.1 字体系统调整
- **Assistant 消息**：
  - 从衬线字体改为现代无衬线字体（优先使用系统字体栈）
  - 字体大小从 16px 调整为 15px（平衡可读性和信息密度）
  - 行高从 1.6 调整为 1.5（略微紧凑但仍保持舒适）

- **用户消息**：
  - 保持当前无衬线字体
  - 字号略微调整以保持视觉一致性

#### 2.2 内容密度优化
- 代码块字体大小从 13px 调整为 12px
- 消息气泡内边距优化（assistant 从 16px 20px 调整为 14px 18px）
- 消息间距从 16px 调整为 12px

#### 2.3 可读性保障
- 保持足够的对比度（使用现有 Orca 颜色变量）
- 优化代码块、引用块的视觉层次
- 确保链接、粗体、斜体等元素清晰可辨

## Impact

**受影响的规范：**
- `chat-ui` - 聊天界面规范（新增工具状态显示规范）
- `typography` - 字体排版规范（新增规范）

**受影响的代码：**
- `src/views/MessageItem.tsx` - 工具调用和结果显示逻辑
- `src/styles/ai-chat-styles.ts` - 字体和样式定义
- `src/components/ToolStatusIndicator.tsx` - 新组件：工具状态指示器
- `src/utils/tool-display-config.ts` - 新文件：工具显示配置

**用户收益：**
- ✅ 更清晰的工具执行反馈（知道 AI 在做什么）
- ✅ 更流畅的对话体验（减少技术细节干扰）
- ✅ 更高的屏幕利用率（每屏显示更多内容）
- ✅ 更优雅的视觉呈现（现代化字体设计）
- ✅ 保持易读性（科学的字号和行高设置）

**非破坏性：**
- 工具调用逻辑不变，仅改变UI呈现
- 用户仍可通过 hover 菜单查看完整的技术细节
- 字体调整仅影响视觉，不影响功能
- 所有现有消息格式兼容

## Implementation Phases

**Phase 1: 工具状态显示优化（优先）**
1. 创建 ToolStatusIndicator 组件（支持不同工具类型的动态图标）
2. 创建工具显示配置系统（定义每个工具的图标、文本、状态）
3. 重构 MessageItem.tsx 中的 ToolCallItem 和 ToolResultItem
4. 添加 CSS 动画（闪烁、脉动等）

**Phase 2: 字体排版优化**
1. 更新 markdownContainerStyle 字体设置
2. 调整消息气泡、代码块的尺寸和间距
3. 测试可读性（在真实内容下验证）
4. 微调直至达到最佳平衡

## Success Metrics

- 用户能快速理解 AI 正在执行的操作（不需要查看技术参数）
- 对话界面的视觉密度提升约 20-30%（更多内容可见）
- 字体调整后用户反馈阅读舒适度不降低
- 工具调用流程感知更流畅（不再有技术感的"卡片割裂"）
